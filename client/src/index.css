@tailwind base;
@tailwind components;
@tailwind utilities;

/* Design System Foundation */
:root {
  /* Brand Color Scale - Teal to Emerald Gradient (preserving existing palette) */
  --brand-50: hsl(166, 76%, 97%);
  --brand-100: hsl(167, 85%, 89%);
  --brand-200: hsl(168, 84%, 78%);
  --brand-300: hsl(170, 77%, 65%);
  --brand-400: hsl(172, 66%, 50%);
  --brand-500: hsl(174, 100%, 29%); /* Existing teal */
  --brand-600: hsl(175, 84%, 32%);
  --brand-700: hsl(175, 77%, 26%);
  --brand-800: hsl(176, 69%, 22%);
  --brand-900: hsl(177, 64%, 18%);
  
  /* Navy Dark Neutral Scale */
  --navy-50: hsl(210, 17%, 98%);
  --navy-100: hsl(213, 20%, 91%);
  --navy-200: hsl(213, 20%, 83%);
  --navy-300: hsl(213, 20%, 65%);
  --navy-400: hsl(213, 19%, 46%);
  --navy-500: hsl(213, 19%, 27%);
  --navy-600: hsl(226, 45%, 20%); /* Existing deep blue */
  --navy-700: hsl(226, 45%, 16%);
  --navy-800: hsl(226, 45%, 12%);
  --navy-900: hsl(210, 11%, 15%); /* Existing graphite */
  
  /* Semantic Colors */
  --success: hsl(142, 76%, 36%);
  --success-foreground: hsl(355, 100%, 97%);
  --warning: hsl(32, 95%, 44%);
  --warning-foreground: hsl(355, 100%, 97%);
  --danger: hsl(0, 84%, 60%);
  --danger-foreground: hsl(355, 100%, 97%);
  
  /* Surface and Text */
  --bg: var(--navy-50);
  --surface: hsl(0, 0%, 100%);
  --text: var(--navy-900);
  --muted: var(--navy-300);
  --accent: hsl(14, 100%, 73%); /* Existing coral */
  
  /* Interactive */
  --ring: var(--brand-500);
  
  /* Fluid Typography Scale */
  --step--1: clamp(0.75rem, 0.85vw + 0.625rem, 0.875rem);
  --step-0: clamp(0.875rem, 1vw + 0.75rem, 1rem);
  --step-1: clamp(1.125rem, 1.2vw + 0.875rem, 1.25rem);
  --step-2: clamp(1.375rem, 1.5vw + 1rem, 1.5rem);
  --step-3: clamp(1.75rem, 2vw + 1.25rem, 2rem);
  --step-4: clamp(2.125rem, 2.5vw + 1.5rem, 2.5rem);
  --step-5: clamp(2.625rem, 3vw + 2rem, 3.25rem);
}

@media (prefers-color-scheme: dark) {
  :root {
    --bg: var(--navy-900);
    --surface: var(--navy-800);
    --text: var(--navy-50);
    --muted: var(--navy-400);
    --ring: var(--brand-400);
  }
}

/* Motion Preferences */
@media (prefers-reduced-motion: reduce) {
  *,
  *::before,
  *::after {
    animation-duration: 0.01ms !important;
    animation-iteration-count: 1 !important;
    transition-duration: 0.01ms !important;
    scroll-behavior: auto !important;
  }
}

/* Hidden Radix poppers must not capture events or focus */
[data-radix-popper-content-wrapper][data-aria-hidden="true"],
[data-radix-popper-content-wrapper][aria-hidden="true"]{
  pointer-events: none !important;
  visibility: hidden !important;
  display: none !important;
}

/* Additional safeguards for Radix UI interference */
[data-radix-popper-content-wrapper] {
  z-index: auto;
}

/* Ensure file inputs have highest priority */
input[type="file"] {
  z-index: 99999 !important;
}

/* Safe Area Support */
.safe-area-padding {
  padding-inline: env(safe-area-inset-left) env(safe-area-inset-right);
}

@layer components {
  /* Elevation System */
  .elevated {
    @apply bg-card border border-border rounded-xl shadow-sm;
  }
  
  .surface-elevated {
    @apply bg-card border border-border rounded-xl shadow-lg;
  }
  
  /* Standardized Spacing */
  .section-spacing {
    @apply py-8 sm:py-12;
  }
  
  .card-spacing {
    @apply p-5 sm:p-6;
  }
  
  .grid-spacing {
    @apply gap-4 sm:gap-6;
  }
  
  /* Touch Target Standards */
  .touch-target {
    @apply h-11 w-11 min-h-11 min-w-11;
  }
  
  /* Button Animations */
  .btn-press {
    transition: transform 0.1s ease;
  }
  
  @media (prefers-reduced-motion: no-preference) {
    .btn-press:active {
      transform: scale(0.98);
    }
  }
  
  @keyframes fadeUp {
    from {
      opacity: 0;
      transform: translateY(12px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
  
  .animate-fade-up {
    animation: fadeUp 0.5s ease-out forwards;
    opacity: 0;
  }
  
  /* App Bar */
  .app-bar {
    @apply sticky top-0 z-40 h-14 md:h-16 bg-background backdrop-blur-md border-b border-border;
    background-color: rgb(from var(--background) r g b / 0.8);
  }
  
  @supports not (color: rgb(from white r g b / 0.8)) {
    .app-bar {
      background-color: var(--background);
    }
  }
}

@layer base {
  body {
    @apply bg-brand-white;
  }
}

/* Shadcn/UI Component Variables */
:root {
  --background: var(--bg);
  --foreground: var(--text);
  --muted: var(--navy-100);
  --muted-foreground: var(--muted);
  --popover: var(--surface);
  --popover-foreground: var(--text);
  --card: var(--surface);
  --card-foreground: var(--text);
  --border: var(--navy-200);
  --input: var(--navy-100);
  --primary: var(--brand-500);
  --primary-foreground: hsl(0, 0%, 100%);
  --secondary: var(--navy-100);
  --secondary-foreground: var(--text);
  --accent: var(--accent);
  --accent-foreground: var(--text);
  --destructive: var(--danger);
  --destructive-foreground: var(--danger-foreground);
  --radius: 0.75rem;
}

.dark {
  --background: var(--bg);
  --foreground: var(--text);
  --muted: var(--navy-800);
  --muted-foreground: var(--muted);
  --popover: var(--surface);
  --popover-foreground: var(--text);
  --card: var(--surface);
  --card-foreground: var(--text);
  --border: var(--navy-700);
  --input: var(--navy-700);
  --primary: var(--brand-400);
  --primary-foreground: var(--navy-900);
  --secondary: var(--navy-800);
  --secondary-foreground: var(--text);
  --accent: var(--accent);
  --accent-foreground: var(--text);
  --destructive: var(--danger);
  --destructive-foreground: var(--danger-foreground);
}

@layer base {
  * {
    @apply border-border;
  }

  html {
    font-family: ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, Inter, sans-serif;
  }

  body {
    @apply antialiased;
    background-color: var(--bg);
    color: var(--text);
    font-size: var(--step-0);
    line-height: 1.6;
  }
  
  h1, h2, h3, h4, h5, h6 {
    text-wrap: balance;
  }
  
  /* Focus Ring Standards */
  :focus-visible {
    @apply outline-none ring-2 ring-ring ring-offset-2;
  }
  
  /* Typography Scale */
  .text-xs { font-size: var(--step--1); }
  .text-sm { font-size: var(--step-0); }
  .text-base { font-size: var(--step-0); }
  .text-lg { font-size: var(--step-1); }
  .text-xl { font-size: var(--step-2); }
  .text-2xl { font-size: var(--step-3); }
  .text-3xl { font-size: var(--step-4); }
  .text-4xl { font-size: var(--step-5); }
}

/* Legacy classes for backward compatibility */
@layer components {
  .brand-blue { color: var(--navy-600); }
  .brand-teal { color: var(--brand-500); }
  .brand-coral { color: var(--accent); }
  .brand-text { color: var(--text); }
  .brand-muted { color: var(--muted); }
}
